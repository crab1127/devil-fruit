define(["avalon","text!login","md5"],function(e,t,n){return function(r){r.innerHTML=t,r.className="login",isSgin=!1;var i=e.define({$id:"login",name:"",password:"",logoImg:cfec.baseUrl+"images/logo.png",isShow:!1,ajax:function(t){if(i.name==""||i.name==0)return!1;if(i.password==""||i.password==0)return!1;var r={j_username:i.name,j_password:n.hex_md5(i.password)};e.post("/cfone/j_spring_security_check",r,function(t){t=JSON.parse(t);if(t&&t.status==="success"){localStorage.setItem("account",i.name);var n=t.data;jItem={listenUrl:n.listenUrl,token:n.token},localStorage.setItem("msgSocket",JSON.stringify(jItem));var r=location.search&&location.search.substr(1).match(/(^|&)redirectUrl=([^&]*)(&|$)/g);r?location.href=decodeURIComponent(r):e.router.navigate("/home")}else t&&t.status==="unlogin"&&console.log("账号名或密码错误")},"json"),t.preventDefault()},url:"",sginIn:function(){isSgin?i.isShow=!0:(i.url="/app/view/sginIn.html",isSgin=!0,i.isShow=!0)},back:function(){window.history.back(-1)}}),s=e.define({$id:"sginInCtrl",email:"",cantonfairId:"",password:"",firstName:"",companyName:"",countryId:"",phoneCode:"",back:function(){i.isShow=!1},fnEmail:function(){},Validate:function(){},sginIn:function(){}});s.$watch("$all",function(t,n){console.log(t,n),/^avalon\-/.test(t)||e.log([t,n,typeof n].join("   "))}),e.scan(r)}});